(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=jQuery;var r=e.n(t);function n(e){for(var t,r=[],n=/{([^}]+)}/gi;null!=(t=n.exec(e));)r.push(t[1]);return r}function o(e){return/^[a-zA-Z].*/.test(e)?':input[name="'+e+'"]':e}function a(e,t,n){for(var o=e+"",a=t.decimalOpts.concat(t.thousandOpts),s=["0","1","2","3","4","5","6","7","8","9","-"],c="",u="",i="",f=-1,l="",g="",d=-1,p=0,h=o.length-1;h>=0;h--)u=o.charAt(h),-1!=r().inArray(u,s)?c=u+c:""==i&&-1!=r().inArray(u,t.decimalOpts)?(f=h,i=u,c="."+c):""==l&&-1!=r().inArray(u,t.thousandOpts)?l=u:""!=g||-1!=r().inArray(u,a)||0!=h&&h!=o.length-1||(g=u,d=h);return""!=i&&(p=o.length-f-1,d>f&&p--),-1!=t.decimalPlaces&&(p=t.decimalPlaces),3===arguments.length&&(""==n.dec&&""!=i&&(n.dec=i),(-1==n.decPlaces&&-1!=p||-1!=n.decPlaces&&-1!=p&&p<n.decPlaces)&&(n.decPlaces=p),""==n.thou&&""!=l&&(n.thou=l),""==n.sym&&""!=g&&(n.sym=g,n.symLoc=d)),t.emptyAsZero&&""==c&&(c="0"),c}var s={"+":{op:"+",precedence:10,assoc:"L",exec:function(e,t){return e+t}},"-":{op:"-",precedence:10,assoc:"L",exec:function(e,t){return e-t}},"*":{op:"*",precedence:20,assoc:"L",exec:function(e,t){return e*t}},"/":{op:"/",precedence:20,assoc:"L",exec:function(e,t){return e/t}},"**":{op:"**",precedence:30,assoc:"R",exec:function(e,t){return Math.pow(e,t)}}},c={e:Math.exp(1),pi:4*Math.atan2(1,1)};function u(e){var t,r,n=e.offset;for(t=0;"0123456789".indexOf(e.string.substr(e.offset,1))>=0&&e.offset<e.string.length;)e.offset++;if("."==e.string.substr(e.offset,1))for(e.offset++;"0123456789".indexOf(e.string.substr(e.offset,1))>=0&&e.offset<e.string.length;)e.offset++;if(e.offset>n)return parseFloat(e.string.substr(n,e.offset-n));if("+"==e.string.substr(e.offset,1))return e.offset++,u(e);if("-"==e.string.substr(e.offset,1))return e.offset++,function(e){return-e}(u(e));if("("==e.string.substr(e.offset,1)){if(e.offset++,t=f(e),")"==e.string.substr(e.offset,1))return e.offset++,t;throw e.error="Parsing error: ')' expected",new Error("parseError")}if(null!=(r=/^[a-z_][a-z0-9_]*/i.exec(e.string.substr(e.offset)))){var o=r[0];if(e.offset+=o.length,o in c)return c[o];throw e.error="Semantic error: unknown variable '"+o+"'",new Error("unknownVar")}throw e.string.length==e.offset?(e.error="Parsing error at end of string: value expected",new Error("valueMissing")):(e.error="Parsing error: unrecognized value",new Error("valueNotParsed"))}function i(e){return"**"==e.string.substr(e.offset,2)?(e.offset+=2,s["**"]):"+-*/".indexOf(e.string.substr(e.offset,1))>=0?s[e.string.substr(e.offset++,1)]:null}function f(e){for(var t=[{precedence:0,assoc:"L"}],r=u(e);;){for(var n=i(e)||{precedence:0,assoc:"L"};n.precedence<t[t.length-1].precedence||n.precedence==t[t.length-1].precedence&&"L"==n.assoc;){var o=t.pop();if(!o.exec)return r;r=o.exec(o.value,r)}t.push({op:n.op,precedence:n.precedence,assoc:n.assoc,exec:n.exec,value:r}),r=u(e)}}function l(e,t){var r={string:e,offset:0};try{var n=f(r);if(r.offset<r.string.length)throw r.error="Syntax error: junk found at offset "+r.offset,new Error("trailingJunk");return n}catch(e){return t.showParseError&&alert("".concat(r.error," (").concat(e,"):\n").concat(r.string.substr(0,r.offset),"<*>").concat(r.string.substr(r.offset))),null}}function g(e,t,r,n,s,c,u){var i="",f={dec:"",decPlaces:-1,thou:"",sym:"",symLoc:-1};$.each($.extend({},u),(function(t,r){for(var o,a=new RegExp(r.rgx,"gi");null!=(o=a.exec(e));){var c=r.exec(o[1],n,s,f);e=e.replace(new RegExp(r.rgx,"gi"),c)}}));for(var g=0;g<t.length;g++){var d=t[g],p=a($(o(d),n).val(),s,f);if(0==p.length)return void r.val("").trigger("change");if(null==l(p,{showParseError:!1}))return void r.val("").trigger("change");e=e.replace(new RegExp("{"+d+"}","g"),p)}e=e.replace(/ /g,""),""==f.dec&&(f.dec=s.decimalOpts[0]),-1==f.decPlaces&&(f.decPlaces=0),""==f.thou&&(f.thou=s.thousandOpts[0]);var h=l(e,s);if(i=(i=(i=(i=(i=null==h?"":function(e,t){for(var r=(e.toFixed(t)+"").split("."),n=r.length>1?"."+r[1]:"",o=/(\d+)(\d{3})/,a=r[0];o.test(a);)a=a.replace(o,"$1,$2");return a+n}(h,f.decPlaces)).replace(/\./g,"<c>")).replace(/\,/g,"<t>")).replace(/<c>/g,f.dec)).replace(/<t>/g,f.thou),f.symLoc>-1&&(0==f.symLoc?i=f.sym+i:i+=f.sym),s.smartIntegers&&(i=i.replace(/[\,\.]0+$/,"")),"function"==typeof s.onShowResult&&(i=s.onShowResult.call(r,i)),r.val(i),s.chainFire){var v=r.data("current");void 0!==v&&v===i||(r.data("current",i),r.trigger("change"))}}var d="_jautocalc",p="focus change blur";function h(e,t,r,a){return e.each((function(){var e=$(this);$("["+t.attribute+"]:not(["+d+"])",e).each((function(){var s=$(this),c=s.attr(t.attribute),u=n(c);if(0!=u.length){for(var i=0;i<u.length;i++)if(0==$(o(u[i]),e).length)return;t.keyEventsFire&&(p+=" keyup keydown keypress");for(var f=p.split(" ").join(".jautocalc "),l=0;l<u.length;l++){var h=u[l];$(o(h),e).on(f,{equation:c,equationFields:u,result:s,context:e,opts:t,vars:r,funcs:a},(function(e){g(e.data.equation,e.data.equationFields,e.data.result,e.data.context,e.data.opts,e.data.vars,e.data.funcs)}))}t.readOnlyResults&&s.attr("readonly","readonly"),s.attr(d,d),t.initFire&&$(o(u[0]),e).trigger("change")}}))}))}function v(e,t){return e.each((function(){var e=$(this);$("["+t.attribute+"]["+d+"]",e).each((function(){var r=$(this),a=n(r.attr(t.attribute));if(0!=a.length){for(var s=0;s<a.length;s++){var c=a[s];$(o(c),e).off(".jautocalc")}t.readOnlyResults&&r.removeAttr("readonly"),r.removeAttr(d)}}))}))}var y={sum:{rgx:"sum\\({([^}]+)}\\)",exec:function(e,t,n,s){var c=0;return r()(o(e),t).each((function(){var e=parseFloat(a(r()(this).val(),n,s));c+=e})),c}},avg:{rgx:"avg\\({([^}]+)}\\)",exec:function(e,t,n,s){var c=0,u=r()(o(e),t).each((function(){var e=parseFloat(a(r()(this).val(),n,s));c+=e})).length;return c/u}},min:{rgx:"min\\({([^}]+)}\\)",exec:function(e,t,n,s){return Math.min.apply(this,r()(o(e),t).map((function(e,t){return a(r()(t).val(),n,s)})).get())}},max:{rgx:"max\\({([^}]+)}\\)",exec:function(e,t,n,s){return Math.max.apply(this,r()(o(e),t).map((function(e,t){return a(r()(t).val(),n,s)})).get())}},count:{rgx:"count\\({([^}]+)}\\)",exec:function(e,t){return r()(o(e),t).length}},countNotEmpty:{rgx:"countNotEmpty\\({([^}]+)}\\)",exec:function(e,t){return r().grep(r()(o(e),t),(function(e){return(r()(e).val()+"").length>0})).length}}};function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r().fn.jAutoCalc=Object.assign((function(){for(var e="init",t=r().extend({},r().fn.jAutoCalc.defaults),n={init:h,destroy:v},o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];for(var u=0,i=a;u<i.length;u++){var f=i[u];"string"==typeof f&&(e=f.toString()),"object"===x(f)&&(t=r().extend(t,f))}var l=r().extend({},y,t.funcs),g=r().extend([],c,t.vars);return n[e]?n[e](this,t,g,l):h(this,t,g,l)}),{defaults:{attribute:"jAutoCalc",thousandOpts:[",","."," "],decimalOpts:[".",","],decimalPlaces:-1,initFire:!0,chainFire:!0,keyEventsFire:!1,readOnlyResults:!0,showParseError:!0,emptyAsZero:!1,smartIntegers:!1,onShowResult:null,funcs:{},vars:{}}})})();
//# sourceMappingURL=jautocalc.js.map